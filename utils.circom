
pragma circom 2.0.3;
template Multiplier2 () {  

    // Declaration of signals.  
    signal input in1;  
    signal input in2;  
    signal output out;  
    
    // Constraints.  
    out <== in1 * in2;  
}
     
template MultiplierN (N){
    //Declaration of signals and components.
    signal input in[N];
    signal output out;
    component comp[N-1];

    //Statements.
    for(var i = 0; i < N-1; i++){
        comp[i] = Multiplier2();
    }

        comp[0].in1 <== in[0];
        comp[0].in2 <== in[1];
        for(var i = 0; i < N-2; i++){
        comp[i+1].in1 <== comp[i].out;
        comp[i+1].in2 <== in[i+2]; 
        }
        out <== comp[N-2].out; 
}

template Poseidon4() {
    signal input in1;
    signal input in2;
    signal input in3; 
    signal input in4; 

    signal output out; 

    component p = Poseidon(4);
    p.inputs[0] <== in1;
    p.inputs[1] <== in2;
    p.inputs[2] <== in3;
    p.inputs[3] <== in4;

    out <== p.out;
}

template PoseidonMulti(N) {
    signal input in[N];
    signal input blind;
    signal output out;

    var nHashes = N\3;

    component hashes[nHashes];

    for (var i = 0; i < nHashes;i++) { 
        hashes[i] = Poseidon4();
    }

    var cursor = 0;
    hashes[0].in1 <== blind; 
    hashes[0].in2 <== in[0];
    hashes[0].in3 <== in[1];
    hashes[0].in4 <== in[2];
    
    cursor+=2;

    for (var i = 0; i < nHashes-1; i++) {
        hashes[i+1].in1 <== hashes[i].out;
        hashes[i+1].in2 <== in[cursor+1];
        hashes[i+1].in3 <== in[cursor+2];
        hashes[i+1].in4 <== in[cursor+3];
        cursor+=3;
    }

    var rem = N%3;
    if (rem==0) {
        out <== hashes[nHashes-1].out;
    } else {
        component final = Poseidon(rem+1);
        final.inputs[0] <== hashes[nHashes-1].out;
        for (var i=1; i<=rem; i++) { 
            final.inputs[i] <== in[cursor+i];
        }
        out <== final.out;
        
    }

}
function rootsTrans(i) {
	var roots[1664] = [4980,21555,7853,10900,4967,18617,1041,10380,144,18851,9693,12585,14002,4187,14457,19189,19345,19891,6267,183,9179,4863,16199,3420,18981,8347,1678,13404,15120,2601,13313,8672,10653,13690,235,8698,18526,18604,18682,7008,20086,16494,7320,14132,14366,21321,2562,17655,19137,1379,9166,14613,5084,11987,16420,16082,20268,1639,7671,11108,11727,13729,9920,10965,2913,12370,4486,13859,2952,20905,13599,12416,1015,40,5162,820,19540,12078,11831,12494,21243,20489,8269,6657,17135,18435,1119,4434,9790,12169,14301,12520,14314,10419,12052,5643,12663,664,3186,3628,5695,13820,677,15692,16940,16927,20177,17122,14756,14886,1418,20762,1756,20476,7827,13417,19332,16524,14444,3277,7866,9140,14210,9621,7411,16680,18500,17005,11134,8295,18760,9699,11368,17148,8373,11056,2783,5591,10614,11004,14418,16628,14028,16446,20957,21113,10471,2991,16576,4785,16186,9712,1990,10848,11896,9244,19371,1080,10575,625,2835,5188,8802,1405,10757,11433,5734,4577,3732,11974,11714,13131,781,11766,2666,248,13482,16979,20918,17213,9907,1067,20502,12832,13183,14964,14769,16329,6930,8581,4616,8308,6163,6280,14379,6176,13235,3940,3992,11173,19644,13794,7034,6774,8594,2653,4720,13807,9101,1704,15445,13456,3368,16134,2510,16472,19423,20892,20983,8893,19826,18136,2003,4564,8854,10497,11675,8529,8711,11303,9569,4839,15250,17551,4304,5552,19384,20710,20645,6891,15562,20801,20879,20970,12910,5318,12208,4772,7385,14743,2198,6020,3537,19865,9075,339,10146,3511,17733,2822,20996,4005,6800,118,3550,17538,15029,12897,16264,19683,17304,7736,1028,11589,12468,6189,15575,15666,10874,2042,8334,4629,19943,18422,18890,1522,2731,5331,7125,10627,11082,3394,3121,12767,7138,9335,12889,16108,495,3875,8169,18045,18240,14834,14054,17525,7658,8516,17616,4707,19397,1132,15848,6423,11251,11485,13651,5032,12728,14704,5604,16290,1626,9829,15601,9517,12156,15744,15926,7944,2081,16966,9270,8880,18162,9868,11602,20944,2796,18123,5721,20515,14899,18747,3524,17044,5630,8503,4356,11121,9894,7606,13014,19839,15484,11615,16745,9608,9348,14145,14951,3342,4395,5019,7632,7216,10796,14353,18721,20541,209,404,6982,10978,274,3823,4538,1262,5305,11147,11459,13092,9660,13612,14509,8555,15523,10770,16693,8815,9218,13833,3654,17252,17681,15211,18942,18955,7229,16992,17057,19033,13300,9990,5526,16849,20021,1665,6033,15731,2120,18656,16160,20463,20736,10536,21425,21594,18058,6735,11524,19462,21360,7541,4798,10328,326,547,8924,12559,15887,19579,4096,1158,13638,2965,5929,11870,20372,19904,7164,7619,15289,6345,16498,8568,10055,2146,1275,16433,19735,15861,17902,6306,2302,1002,14483,1314,15939,8724,14977,18149,1691,7528,8763,9504,14067,13365,17642,12988,5240,5487,8451,13053,3264,17954,11740,4226,11922,13495,18305,18539,5045,3693,7268,19280,14730,13976,16355,19449,18864,17720,6527,20424,3407,16901,1340,1769,11511,13105,9972,4083,5903,17083,1964,2523,12754,6748,11641,12819,7723,911,8841,8964,10016,7957,7710,9725,10991,690,12962,16706,20242,3901,2211,807,1366,4135,4590,6202,8867,3745,13352,18877,6059,6007,7021,21217,21529,4239,21087,17096,19800,6397,15393,3602,19917,7515,6358,14574,8217,8477,18630,14938,937,833,12858,16225,4655,12689,18344,7372,12292,20723,21386,6566,2315,3927,10133,11779,3966,18448,16862,16095,21581,3173,3082,18266,17018,2887,7294,5097,5383,5136,12715,9296,6787,5006,12793,13716,16459,13872,18669,20775,6969,1886,18201,20073,6371,14561,15341,13768,18214,6410,13937,7463,638,1223,17668,17928,10666,19267,21191,10939,17876,3316,3290,3030,261,2055,3498,13911,15094,15536,17226,5253,19969,15978,19527,1184,21126,13027,3199,742,16758,19319,13287,5682,3472,19410,1821,859,4317,14587,17239,11017,13079,15510,755,3667,10393,12091,16147,4954,14041,15432,196,11909,9465,8191,13118,4057,16875,4902,7437,18903,7333,15822,1730,6072,950,6670,10406,8737,12344,12923,20138,13196,3641,5799,5838,17265,2068,4551,10887,12396,3446,508,3680,10718,15783,17772,21503,13066,18188,13755,2640,17629,4525,8438,10692,6631,10705,11329,16589,6111,17837,14860,8178,3108,15367,14912,10510,12572,2978,7190,10835,18786,20840,19748,2874,9777,6085,13989,9803,365,6904,11160,11961,14717,15679,20580,2419,1197,14015,27,9322,2614,9530,7359,13521,15016,1938,4369,3225,976,5851,7047,15900,963,16017,17356,17850,17941,9561,15354,17200,18016,19488,21269,3043,18097,8256,9738,17382,13144,6137,12845,9114,9439,1483,13963,18409,17161,443,10562,18591,11407,17447,12039,4681,7255,14535,15003,20333,14405,19150,19696,20749,13443,12305,1288,15913,19787,7749,10250,15302,2484,53,10601,12624,14665,15055,9205,6878,15471,3758,9673,12318,9088,21334,1497,7931,19982,14223,6722,5071,4460,3160,12130,8951,21451,9881,9387,10822,170,6683,8646,15653,15705,17291,1561,18578,13261,4759,482,4343,12429,13885,21009,6319,5760,729,8386,8607,15952,222,300,21048,12676,17577,7580,12104,16238,13040,3017,15172,5266,6813,18838,11342,7775,14,20346,13430,14873,7346,10107,14691,14990,19995,4876,12702,5422,17434,2497,4824,18318,8412,1301,11662,20554,19852,16511,19306,2328,17863,6865,11857,7879,5617,12331,2770,2172,9647,19202,5942,18292,1951,10289,12026,11701,18487,18773,12741,9192,1587,19618,6257,8113,20203,4018,3771,3238,10263,1717,4278,4213,18708,16550,19358,10913,4928,2926,2224,2627,4447,18812,19475,2809,7788,12780,10198,10367,12949,14626,21373,18019,3589,6696,9257,17824,7996,13326,16316,9634,1613,6761,5409,14080,5435,20307,7450,5994,9068,17330,13703,4694,12260,11805,8620,10224,12611,14106,2744,14470,9822,4850,18110,19163,11948,21568,1509,21022,11316,14639,20931,20008,20229,3251,15146,16810,9842,5955,9452,8776,17031,18929,7593,3784,19631,7892,19709,9543,14158,5201,5500,8321,15328,12195,5565,19111,20567,7424,21308,21470,7814,1925,6917,7762,599,1,6943,14431,15276,4174,11753,18565,20099,6956,5227,5786,12507,14847,10341,11381,20853,6462,5708,12975,1808,2367,16719,1860,1470,7983,5357,287,7476,2861,1977,1912,9029,2939,11498,20866,2432,534,19774,19501,13339,3719,14600,3810,5864,11563,7242,13846,19085,16030,14392,11238,14236,5669,11043,15718,8399,8990,13222,7697,352,8633,10185,16004,12403,6046,17798,12143,11446,20528,16537,4746,4473,14496,13469,12239,4330,1652,7489,2900,6436,4382,4408,2536,5968,12533,12650,12806,2718,1249,8932,15627,17278,8204,15133,2705,11550,18734,14652,4915,1535,7398,11225,21230,79,18396,20060,20151,16212,18227,6540,6839,10159,11649,10029,11264,11290,9582,3212,7203,7684,19605,19293,4044,15991,17369,17174,20411,7801,5448,20294,19956,13547,18461,2380,21412,1899,2549,92,8542,9309,16888,18799,18825,2263,19553,19072,15458,20606,846,17187,8828,157,20125,430,14327,7177,10926,3459,3004,989,5110,2757,9016,2237,1353,2471,885,13950,4200,20671,2679,6475,7307,11277,8360,16914,19241,6644,19670,1171,16069,16641,18253,13378,13274,10432,13625,5058,2575,17421,21295,12357,11069,7554,11394,16173,4499,12383,18175,9055,105,4889,11030,20450,16368,13781,13170,2107,20034,3069,7645,1782,560,21256,3576,10783,12000,16797,21399,9959,8230,6384,6150,10042,2848,651,2016,2588,8490,8789,7567,11844,3836,11935,8100,15185,9491,15224,10445,15081,15640,11576,12221,12455,2341,2692,16277,16303,17109,19176,19566,1795,3979,5214,8022,11212,3862,19603,20814,11355,15042,21061,19878,131,3706,10094,19514,5175,4161,1210,16381,8074,10172,21152,18357,417,13924,16953,9231,2458,10952,1431,11199,313,13664,4421,6826,12598,11537,8685,10120,794,13248,9153,9283,8061,4252,3095,1392,9595,14119,15159,15796,3914,16654,16771,17980,7970,13157,7099,7151,18331,18513,18643,4265,19007,19059,612,4109,5825,10523,9127,17915,15406,5747,5877,20164,20359,20437,21100,21178,14678,8425,21490,19813,4512,12013,13560,2276,1054,3563,898,3615,4642,8035,12117,15835,12481,9374,7073,16667,16394,17603,14340,1457,4733,8659,10640,17473,17694,17759,17785,8911,1145,10081,12442,15419,19020,19098,19228,20190,7112,10744,21165,13209,17993,5656,21516,9426,21607,7502,20684,9751,8243,2393,3329,20255,20112,6514,14548,3485,4993,5123,10731,14184,19124,6579,6592,17590,2406,1236,15107,20788,18071,9361,20385,14821,8282,8977,16251,12637,20320,14197,14925,10211,21438,10809,9855,4603,10276,17499,5292,16056,17486,6553,1574,1600,18994,391,18695,4811,20827,21204,16563,16602,10315,2354,20281,11688,14816,12936,3355,13677,15614,8009,6852,2250,2445,17564,6618,16407,14288,9003,15263,8087,19254,16342,1444,10484,5539,573,4941,3953,9400,14795,19436,5513,18032,3134,8048,10549,11472,9413,14093,17746,19930,4031,15068,9946,703,14782,3849,3147,15497,10588,4122,7905,3381,5149,768,2159,5773,5396,5890,6995,8464,10068,14522,469,924,16121,1873,3888,17811,21282,6605,16615,13391,4148,9042,15237,15315,3303,15965,18552,1093,10354,8152,15809,17967,9478,11420,15874,19657,5461,19722,6449,13534,15588,10302,6228,2185,7281,11628,1743,6124,13508,13586,16823,4668,18474,8126,18916,378,5370,7060,7086,10237,10679,15549,18383,18279,13573,11186,1327,716,20697,12279,5474,2133,6098,17395,20658,17317,18370,15380,12182,13898,10861,21347,20216,6488,6501,3797,1548,521,16043,14262,2289,14249,456,1847,8750,12065,20619,2029,4070,15770,17408,18968,16836,1106,19761,6709,19215,20593,20632,12546,17070,2094,17707,20398,21620,10003,5812,5344,6241,17889,12252,21477,6293,11883,6215,6332,66,15757,15198,9764,7918,17343,21074,5981,14275,18084,11792,11818,9933,3056,19046,21542,10458,1834,16784,20047,5279,3433,5916,5578,17512,12871,586,872,8139,4291,7840,17460,16732,21139,13742,13001,14171,21035,11095];
	return roots[i];
    }
function rootsMatch(i) {
	var roots[1] = [6];
	return roots[i];
    }
